<!DOCTYPE html>
<html>
    <head>
        <title>Deploying your MigAz-generated template to Azure Resource Manager</title>
        <style type="text/css">
            body
            {
                font-family: Segoe UI Light; 
                background-color: white;
            }
            pre
            {
                font-family: Lucida Console;
                font-size: 9pt;
                background-color: #dddddd;
                border: 1px solid #aaaaaa;
                padding: 5px;
            }
        </style>
    </head>
    <body>
        <h1>Deploying your MigAz-generated template to Azure Resource Manager</h1>
        <p>Congratulations! You just used <a href="http://aka.ms/migaz">MigAz</a> to export some Classic Azure resources
        to an Azure Resource Manager (ARM) template. To use your new resources you'll need to deploy this template to Azure.
        Here's what you need to do.</p>

        <ol>
            <li>
                <p>Review and modify the generated template as needed to ensure it meets your requirements.</p>
                <p>Your template is located at <a href="C:\Temp\SLG\MigAz\HBI\VNET\W2\export.json">C:\Temp\SLG\MigAz\HBI\VNET\W2\export.json</a>.
            </li>
            <li>
                <p>Open Azure PowerShell and sign into your target subscription.</p>
<pre>Login-AzureRmAccount
Select-AzureRmSubscription -SubscriptionId "ec1cea2e-92aa-45a7-89b0-d9fc40df2beb"</pre>
            </li>
            <li>
                <p>Create a new Resource Group in your chosen region</p>
<pre>New-AzureRmResourceGroup -Name "mac_slg_managed_VNET_w2" -Location "West US 2"</pre>
            </li>
            <li>
                <p>Deploy your template to the new Resource Group. Note you will see errors relating to missing VHD files if your 
                    template contains VMs. This is expected.</p>
<pre>New-AzureRmResourceGroupDeployment -TemplateFile "C:\Temp\SLG\MigAz\HBI\VNET\W2\export.json" -ResourceGroupName "mac_slg_managed_VNET_w2"</pre>
            </li>
            <li>
                <p>If your template contains VMs, run the script to snapshot and copy the VHDs from your source to your target 
                    storage accounts</p>
<pre>C:\Users\WILLS\Downloads\migAz v1.4.9.0\BlobCopy.ps1 -ResourcegroupName "mac_slg_managed_VNET_w2" `
    -DetailsFilePath "C:\Temp\SLG\MigAz\HBI\VNET\W2\copyblobdetails.json" -StartType StartBlobCopy
    
C:\Users\WILLS\Downloads\migAz v1.4.9.0\BlobCopy.ps1 -ResourcegroupName "mac_slg_managed_VNET_w2" `
    -DetailsFilePath "C:\Temp\SLG\MigAz\HBI\VNET\W2\copyblobdetails.json" -StartType MonitorBlobCopy
</pre>
            </li>
            <li>
                <p>Once the copy has completed, redeploy the template to your resource group to fix up the VHD file locations.</p>
<pre>New-AzureRmResourceGroupDeployment -TemplateFile "C:\Temp\SLG\MigAz\HBI\VNET\W2\export.json" -ResourceGroupName "mac_slg_managed_VNET_w2"</pre>
            </li>
        </ol>
        <p>Once you are happy that all is well with your ARM deployment, you can delete your old classic deployment.
            Thank you for using MigAz!</p>
    </body>
</html>